<!-- Generated by SpecStory -->

# Add short IDs to JSON outline file (2025-08-11 23:26Z)

_**User**_

I know we're using the long ids but when the .outline file is created can you also use the short id that is found in the url and write that to the json .outline file as well so we also have that even though we use the other

---

_**Assistant**_

I'll help you add the short ID to the .outline file. Let me first examine the current code to understand how the .outline files are created and where the short ID can be extracted from.

---

Read file: undefined

---

<details>
                <summary>Searched codebase "How are .outline files created and what data is written to them?" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `inc/FileOperations.php` | Lundefined-63 |
| `fullsync.php` | L317-368 |
| `inc/FileSystemScanner.php` | L170-237 |
| `inc/FileOperations.php` | L267-334 |
| `inc/RemoteSync.php` | L232-290 |
| `inc/FileSystemScanner.php` | Lundefined-55 |
| `inc/FileSystemScanner.php` | L51-107 |
| `inc/FileOperations.php` | L56-109 |
| `inc/RemoteSync.php` | L184-236 |
| `inc/FileOperations.php` | L215-274 |
| `init/init.php` | Lundefined-57 |
| `fullsync.php` | L557-604 |
| `fullsync.php` | L220-263 |
| `inc/RemoteSync.php` | Lundefined-61 |
| `fullsync.php` | L366-413 |

</details>

---

Now let me search for where the short ID might be available in the document data and where .outline files are currently written:

---

<details>
                <summary>Searched codebase "Where can I find short ID or URL in document data from Outline API?" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `inc/RemoteSync.php` | L232-290 |
| `inc/RemoteSync.php` | L96-160 |
| `fullsync.php` | L317-368 |
| `inc/RemoteSync.php` | Lundefined-61 |
| `fullsync.php` | L557-604 |
| `fullsync.php` | L512-559 |
| `inc/RemoteSync.php` | L184-236 |
| `inc/RemoteSync.php` | L285-331 |
| `inc/FileSystemScanner.php` | L51-107 |
| `inc/FileOperations.php` | L56-109 |
| `inc/FileOperations.php` | L330-381 |
| `inc/FileOperations.php` | Lundefined-63 |
| `fullsync.php` | L220-263 |
| `fullsync.php` | L366-413 |
| `fullsync.php` | L410-460 |

</details>

---



---

Perfect! I can see that:

1. The short ID is available as `urlId` in the document data structure (line 104 in RemoteSync.php)
2. The .outline file is created and updated in the `FileSystemScanner::saveMetadata()` method
3. The frontmatter in markdown files is created in `FileOperations::buildMarkdownContent()` method

Let me check what the current .outline file structure looks like and then modify the code to include the short ID:

---

## Todo List

- [ ] Add short ID (urlId) to markdown file frontmatter when creating/updating files
- [ ] Include short ID in .outline file metadata for document mapping
- [ ] Test that short ID is properly extracted and stored in both frontmatter and metadata

---

Read file: undefined

---

Let me look at the updateMarkdownFile method and see how the frontmatter is being updated:

---

Read file: undefined

---

## Todo List

- [-] Add short ID (urlId) to markdown file frontmatter when creating/updating files
- [ ] Include short ID in .outline file metadata for document mapping
- [ ] Test that short ID is properly extracted and stored in both frontmatter and metadata

---

Now I'll modify the FileOperations.php file to add the short ID to the frontmatter:

---

<details><summary>Edit file: /Users/Reess/Desktop/outline-full-sync/inc/FileOperations.php</summary>

undefined

**Chunk 1**
Lines added: 5, lines removed: undefined

```diff
@@ -44,4 +44,9 @@
              'id_outline' => $document['id']
          ];
+         
+         // Add short ID if available
+         if (isset($document['urlId']) && !empty($document['urlId'])) {
+             $frontmatter['short_id'] = $document['urlId'];
+         }
          
          // Create content
```

</details>

---

<details><summary>Edit file: /Users/Reess/Desktop/outline-full-sync/inc/FileOperations.php</summary>

undefined

**Chunk 1**
Lines added: 5, lines removed: undefined

```diff
@@ -83,4 +83,9 @@
          // Update frontmatter with new document ID
          $existingFrontmatter['id_outline'] = $document['id'];
+         
+         // Add short ID if available
+         if (isset($document['urlId']) && !empty($document['urlId'])) {
+             $existingFrontmatter['short_id'] = $document['urlId'];
+         }
          
          // Extract existing content (without frontmatter)
```

</details>

---

Now I need to add the short ID to the .outline metadata file. Let me check where that's built and update it:

---

## Todo List

- [x] Add short ID (urlId) to markdown file frontmatter when creating/updating files
- [-] Include short ID in .outline file metadata for document mapping
- [ ] Test that short ID is properly extracted and stored in both frontmatter and metadata

---

Read file: undefined

---

Perfect! I can see where the document mapping is built. I need to add the short ID to each document mapping entry:

---

<details><summary>Edit file: /Users/Reess/Desktop/outline-full-sync/fullsync.php</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: undefined

```diff
@@ -467,4 +467,5 @@
              $documentMapping[] = [
                  'id' => $doc['id'],
+                 'short_id' => $doc['urlId'] ?? null,
                  'title' => $doc['title'],
                  'parent_id' => $doc['parentDocumentId'],
```

</details>

---

Now let me check if there are any syntax errors in the updated files:

---

